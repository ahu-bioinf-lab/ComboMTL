2025-06-09 14:24:57,206 - train - INFO - ComboMTL(
  (protein_embedding): Embedding(15970, 128)
  (cell_embedding): Embedding(76, 128)
  (drug_embedding): Embedding(764, 128)
  (aggregation_function): Linear(in_features=384, out_features=128, bias=True)
  (neighbor_proj): Linear(in_features=128, out_features=512, bias=True)
  (trans_Q): Linear(in_features=384, out_features=128, bias=True)
  (trans_K): Linear(in_features=384, out_features=128, bias=True)
  (trans_V): Linear(in_features=384, out_features=128, bias=True)
  (linears): ModuleList(
    (0): Linear(in_features=128, out_features=384, bias=True)
    (1): Linear(in_features=128, out_features=384, bias=True)
    (2): Linear(in_features=128, out_features=384, bias=True)
    (3): Linear(in_features=128, out_features=384, bias=True)
  )
  (projection): Linear(in_features=384, out_features=384, bias=True)
  (attention_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=False)
    (1): Linear(in_features=128, out_features=128, bias=False)
    (2): Linear(in_features=128, out_features=128, bias=False)
  )
  (actP): PReLU(num_parameters=1)
  (drop_out): Dropout(p=0.5, inplace=False)
  (global_attn): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): GELU(approximate=none)
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (local_attn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): GELU(approximate=none)
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (out_transform): Linear(in_features=128, out_features=128, bias=True)
  (transform): Linear(in_features=256, out_features=256, bias=True)
  (gate): Linear(in_features=256, out_features=256, bias=True)
  (carry): Linear(in_features=256, out_features=256, bias=True)
  (syfcn): Sequential(
    (0): Linear(in_features=384, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=1, bias=True)
  )
  (sifcn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=1, bias=True)
  )
)
Trainable parameters: 3155973
2025-06-09 14:29:58,676 - trainer - INFO - epoch: 1
2025-06-09 14:29:58,677 - trainer - INFO -     train          : loss           : 0.62	accuracy       : 0.61	precision      : 0.52	recall         : 0.42	roc_auc        : 0.66	pr_auc         : 0.61	f1_score       : 0.43	
2025-06-09 14:29:58,677 - trainer - INFO -     validation     : val_loss       : 0.59	val_accuracy   : 0.65	val_precision  : 0.64	val_recall     : 0.54	val_roc_auc    : 0.70	val_pr_auc     : 0.66	val_f1_score   : 0.58	
2025-06-09 14:29:58,724 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 14:35:03,633 - trainer - INFO - epoch: 2
2025-06-09 14:35:03,634 - trainer - INFO -     train          : loss           : 0.58	accuracy       : 0.66	precision      : 0.64	recall         : 0.57	roc_auc        : 0.72	pr_auc         : 0.67	f1_score       : 0.61	
2025-06-09 14:35:03,634 - trainer - INFO -     validation     : val_loss       : 0.58	val_accuracy   : 0.66	val_precision  : 0.65	val_recall     : 0.58	val_roc_auc    : 0.72	val_pr_auc     : 0.68	val_f1_score   : 0.61	
2025-06-09 14:35:03,685 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 14:40:07,193 - trainer - INFO - epoch: 3
2025-06-09 14:40:07,193 - trainer - INFO -     train          : loss           : 0.57	accuracy       : 0.67	precision      : 0.65	recall         : 0.58	roc_auc        : 0.73	pr_auc         : 0.69	f1_score       : 0.61	
2025-06-09 14:40:07,194 - trainer - INFO -     validation     : val_loss       : 0.57	val_accuracy   : 0.66	val_precision  : 0.65	val_recall     : 0.57	val_roc_auc    : 0.73	val_pr_auc     : 0.69	val_f1_score   : 0.60	
2025-06-09 14:40:07,244 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 14:45:08,465 - trainer - INFO - epoch: 4
2025-06-09 14:45:08,466 - trainer - INFO -     train          : loss           : 0.57	accuracy       : 0.67	precision      : 0.66	recall         : 0.57	roc_auc        : 0.73	pr_auc         : 0.69	f1_score       : 0.61	
2025-06-09 14:45:08,466 - trainer - INFO -     validation     : val_loss       : 0.57	val_accuracy   : 0.67	val_precision  : 0.66	val_recall     : 0.55	val_roc_auc    : 0.73	val_pr_auc     : 0.70	val_f1_score   : 0.60	
2025-06-09 14:45:08,518 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 14:50:08,760 - trainer - INFO - epoch: 5
2025-06-09 14:50:08,760 - trainer - INFO -     train          : loss           : 0.57	accuracy       : 0.67	precision      : 0.67	recall         : 0.57	roc_auc        : 0.74	pr_auc         : 0.70	f1_score       : 0.61	
2025-06-09 14:50:08,761 - trainer - INFO -     validation     : val_loss       : 0.56	val_accuracy   : 0.67	val_precision  : 0.66	val_recall     : 0.59	val_roc_auc    : 0.74	val_pr_auc     : 0.71	val_f1_score   : 0.62	
2025-06-09 14:50:08,808 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 14:55:15,427 - trainer - INFO - epoch: 6
2025-06-09 14:55:15,428 - trainer - INFO -     train          : loss           : 0.56	accuracy       : 0.68	precision      : 0.68	recall         : 0.58	roc_auc        : 0.75	pr_auc         : 0.71	f1_score       : 0.62	
2025-06-09 14:55:15,428 - trainer - INFO -     validation     : val_loss       : 0.56	val_accuracy   : 0.68	val_precision  : 0.68	val_recall     : 0.56	val_roc_auc    : 0.74	val_pr_auc     : 0.72	val_f1_score   : 0.61	
2025-06-09 14:55:15,481 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:00:15,503 - trainer - INFO - epoch: 7
2025-06-09 15:00:15,504 - trainer - INFO -     train          : loss           : 0.55	accuracy       : 0.69	precision      : 0.68	recall         : 0.59	roc_auc        : 0.75	pr_auc         : 0.72	f1_score       : 0.63	
2025-06-09 15:00:15,504 - trainer - INFO -     validation     : val_loss       : 0.55	val_accuracy   : 0.68	val_precision  : 0.68	val_recall     : 0.59	val_roc_auc    : 0.75	val_pr_auc     : 0.73	val_f1_score   : 0.63	
2025-06-09 15:00:15,554 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:05:23,035 - trainer - INFO - epoch: 8
2025-06-09 15:05:23,036 - trainer - INFO -     train          : loss           : 0.55	accuracy       : 0.69	precision      : 0.68	recall         : 0.60	roc_auc        : 0.76	pr_auc         : 0.73	f1_score       : 0.64	
2025-06-09 15:05:23,036 - trainer - INFO -     validation     : val_loss       : 0.54	val_accuracy   : 0.70	val_precision  : 0.70	val_recall     : 0.59	val_roc_auc    : 0.76	val_pr_auc     : 0.74	val_f1_score   : 0.64	
2025-06-09 15:05:23,085 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:10:24,848 - trainer - INFO - epoch: 9
2025-06-09 15:10:24,849 - trainer - INFO -     train          : loss           : 0.54	accuracy       : 0.70	precision      : 0.68	recall         : 0.61	roc_auc        : 0.77	pr_auc         : 0.74	f1_score       : 0.65	
2025-06-09 15:10:24,849 - trainer - INFO -     validation     : val_loss       : 0.54	val_accuracy   : 0.69	val_precision  : 0.69	val_recall     : 0.61	val_roc_auc    : 0.76	val_pr_auc     : 0.74	val_f1_score   : 0.64	
2025-06-09 15:10:24,898 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:15:27,224 - trainer - INFO - epoch: 10
2025-06-09 15:15:27,224 - trainer - INFO -     train          : loss           : 0.54	accuracy       : 0.70	precision      : 0.69	recall         : 0.62	roc_auc        : 0.77	pr_auc         : 0.74	f1_score       : 0.65	
2025-06-09 15:15:27,225 - trainer - INFO -     validation     : val_loss       : 0.54	val_accuracy   : 0.70	val_precision  : 0.67	val_recall     : 0.66	val_roc_auc    : 0.76	val_pr_auc     : 0.74	val_f1_score   : 0.67	
2025-06-09 15:15:27,276 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:20:26,396 - trainer - INFO - epoch: 11
2025-06-09 15:20:26,396 - trainer - INFO -     train          : loss           : 0.54	accuracy       : 0.70	precision      : 0.69	recall         : 0.62	roc_auc        : 0.77	pr_auc         : 0.75	f1_score       : 0.65	
2025-06-09 15:20:26,396 - trainer - INFO -     validation     : val_loss       : 0.54	val_accuracy   : 0.70	val_precision  : 0.69	val_recall     : 0.63	val_roc_auc    : 0.77	val_pr_auc     : 0.75	val_f1_score   : 0.66	
2025-06-09 15:20:26,445 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:25:24,410 - trainer - INFO - epoch: 12
2025-06-09 15:25:24,410 - trainer - INFO -     train          : loss           : 0.53	accuracy       : 0.71	precision      : 0.70	recall         : 0.62	roc_auc        : 0.78	pr_auc         : 0.75	f1_score       : 0.66	
2025-06-09 15:25:24,411 - trainer - INFO -     validation     : val_loss       : 0.53	val_accuracy   : 0.70	val_precision  : 0.70	val_recall     : 0.61	val_roc_auc    : 0.78	val_pr_auc     : 0.75	val_f1_score   : 0.65	
2025-06-09 15:25:24,460 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:30:22,874 - trainer - INFO - epoch: 13
2025-06-09 15:30:22,875 - trainer - INFO -     train          : loss           : 0.53	accuracy       : 0.71	precision      : 0.70	recall         : 0.62	roc_auc        : 0.78	pr_auc         : 0.76	f1_score       : 0.66	
2025-06-09 15:30:22,876 - trainer - INFO -     validation     : val_loss       : 0.53	val_accuracy   : 0.70	val_precision  : 0.71	val_recall     : 0.59	val_roc_auc    : 0.78	val_pr_auc     : 0.75	val_f1_score   : 0.64	
2025-06-09 15:30:22,926 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:35:23,279 - trainer - INFO - epoch: 14
2025-06-09 15:35:23,279 - trainer - INFO -     train          : loss           : 0.53	accuracy       : 0.71	precision      : 0.70	recall         : 0.63	roc_auc        : 0.78	pr_auc         : 0.76	f1_score       : 0.66	
2025-06-09 15:35:23,279 - trainer - INFO -     validation     : val_loss       : 0.53	val_accuracy   : 0.71	val_precision  : 0.70	val_recall     : 0.63	val_roc_auc    : 0.78	val_pr_auc     : 0.76	val_f1_score   : 0.66	
2025-06-09 15:35:23,329 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:40:25,457 - trainer - INFO - epoch: 15
2025-06-09 15:40:25,457 - trainer - INFO -     train          : loss           : 0.52	accuracy       : 0.71	precision      : 0.71	recall         : 0.63	roc_auc        : 0.78	pr_auc         : 0.76	f1_score       : 0.66	
2025-06-09 15:40:25,457 - trainer - INFO -     validation     : val_loss       : 0.53	val_accuracy   : 0.71	val_precision  : 0.71	val_recall     : 0.61	val_roc_auc    : 0.78	val_pr_auc     : 0.76	val_f1_score   : 0.65	
2025-06-09 15:40:25,506 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:45:24,234 - trainer - INFO - epoch: 16
2025-06-09 15:45:24,235 - trainer - INFO -     train          : loss           : 0.52	accuracy       : 0.71	precision      : 0.71	recall         : 0.63	roc_auc        : 0.79	pr_auc         : 0.76	f1_score       : 0.67	
2025-06-09 15:45:24,235 - trainer - INFO -     validation     : val_loss       : 0.53	val_accuracy   : 0.71	val_precision  : 0.70	val_recall     : 0.63	val_roc_auc    : 0.78	val_pr_auc     : 0.76	val_f1_score   : 0.66	
2025-06-09 15:45:24,284 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:50:24,880 - trainer - INFO - epoch: 17
2025-06-09 15:50:24,880 - trainer - INFO -     train          : loss           : 0.52	accuracy       : 0.71	precision      : 0.71	recall         : 0.63	roc_auc        : 0.79	pr_auc         : 0.77	f1_score       : 0.67	
2025-06-09 15:50:24,880 - trainer - INFO -     validation     : val_loss       : 0.52	val_accuracy   : 0.71	val_precision  : 0.70	val_recall     : 0.65	val_roc_auc    : 0.78	val_pr_auc     : 0.76	val_f1_score   : 0.67	
2025-06-09 15:50:24,929 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 15:55:26,939 - trainer - INFO - epoch: 18
2025-06-09 15:55:26,940 - trainer - INFO -     train          : loss           : 0.52	accuracy       : 0.72	precision      : 0.71	recall         : 0.63	roc_auc        : 0.79	pr_auc         : 0.77	f1_score       : 0.67	
2025-06-09 15:55:26,940 - trainer - INFO -     validation     : val_loss       : 0.52	val_accuracy   : 0.71	val_precision  : 0.71	val_recall     : 0.62	val_roc_auc    : 0.79	val_pr_auc     : 0.76	val_f1_score   : 0.67	
2025-06-09 15:55:26,987 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:00:26,282 - trainer - INFO - epoch: 19
2025-06-09 16:00:26,282 - trainer - INFO -     train          : loss           : 0.52	accuracy       : 0.72	precision      : 0.71	recall         : 0.63	roc_auc        : 0.79	pr_auc         : 0.77	f1_score       : 0.67	
2025-06-09 16:00:26,282 - trainer - INFO -     validation     : val_loss       : 0.52	val_accuracy   : 0.71	val_precision  : 0.71	val_recall     : 0.62	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.66	
2025-06-09 16:00:26,332 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:05:25,562 - trainer - INFO - epoch: 20
2025-06-09 16:05:25,562 - trainer - INFO -     train          : loss           : 0.51	accuracy       : 0.72	precision      : 0.71	recall         : 0.64	roc_auc        : 0.79	pr_auc         : 0.77	f1_score       : 0.67	
2025-06-09 16:05:25,562 - trainer - INFO -     validation     : val_loss       : 0.52	val_accuracy   : 0.71	val_precision  : 0.70	val_recall     : 0.63	val_roc_auc    : 0.79	val_pr_auc     : 0.76	val_f1_score   : 0.67	
2025-06-09 16:05:25,610 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:10:28,365 - trainer - INFO - epoch: 21
2025-06-09 16:10:28,365 - trainer - INFO -     train          : loss           : 0.51	accuracy       : 0.73	precision      : 0.72	recall         : 0.64	roc_auc        : 0.80	pr_auc         : 0.78	f1_score       : 0.68	
2025-06-09 16:10:28,365 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.71	val_precision  : 0.72	val_recall     : 0.63	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.67	
2025-06-09 16:10:28,412 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:15:29,881 - trainer - INFO - epoch: 22
2025-06-09 16:15:29,882 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.64	roc_auc        : 0.80	pr_auc         : 0.79	f1_score       : 0.68	
2025-06-09 16:15:29,882 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.67	
2025-06-09 16:15:29,930 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:20:33,547 - trainer - INFO - epoch: 23
2025-06-09 16:20:33,547 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.68	
2025-06-09 16:20:33,547 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.79	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 16:20:33,599 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:25:34,317 - trainer - INFO - epoch: 24
2025-06-09 16:25:34,317 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.68	
2025-06-09 16:25:34,318 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.71	val_precision  : 0.71	val_recall     : 0.63	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.67	
2025-06-09 16:25:34,367 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:30:34,900 - trainer - INFO - epoch: 25
2025-06-09 16:30:34,900 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:30:34,901 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.71	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.67	
2025-06-09 16:30:34,946 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:35:20,583 - trainer - INFO - epoch: 26
2025-06-09 16:35:20,583 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.68	
2025-06-09 16:35:20,584 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.71	val_precision  : 0.72	val_recall     : 0.62	val_roc_auc    : 0.79	val_pr_auc     : 0.77	val_f1_score   : 0.67	
2025-06-09 16:40:05,700 - trainer - INFO - epoch: 27
2025-06-09 16:40:05,701 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:40:05,701 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 16:40:05,749 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:44:51,233 - trainer - INFO - epoch: 28
2025-06-09 16:44:51,234 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:44:51,234 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 16:44:51,281 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:49:45,553 - trainer - INFO - epoch: 29
2025-06-09 16:49:45,553 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:49:45,553 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.70	val_recall     : 0.66	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 16:54:34,717 - trainer - INFO - epoch: 30
2025-06-09 16:54:34,717 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:54:34,718 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.63	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 16:54:34,764 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 16:59:20,712 - trainer - INFO - epoch: 31
2025-06-09 16:59:20,713 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 16:59:20,713 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.63	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:04:05,615 - trainer - INFO - epoch: 32
2025-06-09 17:04:05,616 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:04:05,616 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.63	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:08:50,764 - trainer - INFO - epoch: 33
2025-06-09 17:08:50,765 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:08:50,765 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:08:50,811 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:13:35,098 - trainer - INFO - epoch: 34
2025-06-09 17:13:35,098 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:13:35,099 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:13:35,144 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:18:21,063 - trainer - INFO - epoch: 35
2025-06-09 17:18:21,064 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:18:21,064 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.63	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:18:21,110 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:23:06,744 - trainer - INFO - epoch: 36
2025-06-09 17:23:06,745 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:23:06,745 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:27:51,048 - trainer - INFO - epoch: 37
2025-06-09 17:27:51,049 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:27:51,049 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:32:37,415 - trainer - INFO - epoch: 38
2025-06-09 17:32:37,415 - trainer - INFO -     train          : loss           : 0.50	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:32:37,416 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:37:25,042 - trainer - INFO - epoch: 39
2025-06-09 17:37:25,042 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.73	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:37:25,042 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:37:25,089 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:42:11,076 - trainer - INFO - epoch: 40
2025-06-09 17:42:11,077 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:42:11,077 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.63	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:42:11,124 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:46:57,577 - trainer - INFO - epoch: 41
2025-06-09 17:46:57,578 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:46:57,578 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.67	
2025-06-09 17:46:57,624 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:51:44,461 - trainer - INFO - epoch: 42
2025-06-09 17:51:44,462 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.74	recall         : 0.65	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:51:44,462 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:51:44,510 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 17:56:30,588 - trainer - INFO - epoch: 43
2025-06-09 17:56:30,588 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.74	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 17:56:30,589 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 17:56:30,636 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 18:01:17,522 - trainer - INFO - epoch: 44
2025-06-09 18:01:17,522 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.74	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:01:17,522 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.65	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:06:03,824 - trainer - INFO - epoch: 45
2025-06-09 18:06:03,824 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.73	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:06:03,824 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:10:50,900 - trainer - INFO - epoch: 46
2025-06-09 18:10:50,900 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:10:50,900 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.71	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:15:36,910 - trainer - INFO - epoch: 47
2025-06-09 18:15:36,911 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:15:36,911 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:15:36,958 - trainer - INFO - Saving current best: model_best.pth ...
2025-06-09 18:20:22,561 - trainer - INFO - epoch: 48
2025-06-09 18:20:22,562 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:20:22,562 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:25:08,779 - trainer - INFO - epoch: 49
2025-06-09 18:25:08,779 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.74	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:25:08,780 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:30:13,485 - trainer - INFO - epoch: 50
2025-06-09 18:30:13,485 - trainer - INFO -     train          : loss           : 0.49	accuracy       : 0.74	precision      : 0.73	recall         : 0.66	roc_auc        : 0.81	pr_auc         : 0.79	f1_score       : 0.69	
2025-06-09 18:30:13,486 - trainer - INFO -     validation     : val_loss       : 0.51	val_accuracy   : 0.72	val_precision  : 0.72	val_recall     : 0.64	val_roc_auc    : 0.80	val_pr_auc     : 0.78	val_f1_score   : 0.68	
2025-06-09 18:30:13,486 - test - INFO - ComboMTL(
  (protein_embedding): Embedding(15970, 128)
  (cell_embedding): Embedding(76, 128)
  (drug_embedding): Embedding(764, 128)
  (aggregation_function): Linear(in_features=384, out_features=128, bias=True)
  (neighbor_proj): Linear(in_features=128, out_features=512, bias=True)
  (trans_Q): Linear(in_features=384, out_features=128, bias=True)
  (trans_K): Linear(in_features=384, out_features=128, bias=True)
  (trans_V): Linear(in_features=384, out_features=128, bias=True)
  (linears): ModuleList(
    (0): Linear(in_features=128, out_features=384, bias=True)
    (1): Linear(in_features=128, out_features=384, bias=True)
    (2): Linear(in_features=128, out_features=384, bias=True)
    (3): Linear(in_features=128, out_features=384, bias=True)
  )
  (projection): Linear(in_features=384, out_features=384, bias=True)
  (attention_layers): ModuleList(
    (0): Linear(in_features=128, out_features=128, bias=False)
    (1): Linear(in_features=128, out_features=128, bias=False)
    (2): Linear(in_features=128, out_features=128, bias=False)
  )
  (actP): PReLU(num_parameters=1)
  (drop_out): Dropout(p=0.5, inplace=False)
  (global_attn): Sequential(
    (0): Linear(in_features=128, out_features=128, bias=True)
    (1): GELU(approximate=none)
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (local_attn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): GELU(approximate=none)
    (2): Linear(in_features=128, out_features=1, bias=True)
  )
  (out_transform): Linear(in_features=128, out_features=128, bias=True)
  (transform): Linear(in_features=256, out_features=256, bias=True)
  (gate): Linear(in_features=256, out_features=256, bias=True)
  (carry): Linear(in_features=256, out_features=256, bias=True)
  (syfcn): Sequential(
    (0): Linear(in_features=384, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=1, bias=True)
  )
  (sifcn): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.2, inplace=False)
    (3): Linear(in_features=128, out_features=1, bias=True)
  )
)
Trainable parameters: 3155973
2025-06-09 18:30:13,488 - test - INFO - Loading checkpoint: saved\models\DrugCombDB\0609_142446\model_best.pth ...
2025-06-09 18:30:53,406 - test - INFO - {'loss': 0.5131451062964871, 'accuracy': 0.7206740116655865, 'precision': 0.7228959075934327, 'recall': 0.6417543723446388, 'roc_auc': 0.7963428026211565, 'pr_auc': 0.7756024350561677, 'f1_score': 0.6794634539047311}
